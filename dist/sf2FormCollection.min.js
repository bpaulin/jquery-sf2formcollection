/*
 *  sf2FormCollection - v0.2.0
 *  sf2FormCollection
 *  https://github.com/bpaulin/jquery-sf2formcollection
 *
 *  Made by Bruno Paulin
 *  Under MIT License
 */
!function(a){a.fn.sf2FormCollection=function(b){var c=a(this),d={addItem:'<a href="#">Add an item</a>',removeItem:"",tokenIndex:"__NAME__",sortable:!1,sortItem:'<a href="#">Sort</a>'};return params=a.extend(d,b),containerAddElement=a('<div class="sf2fc-add"></div>'),addElement=a(params.addItem),items=a('<div class="sf2fc-items"></div>'),c.children("*").each(function(){item=a('<div class="sf2fc-item"></div>'),a(this).detach().appendTo(item),item.appendTo(items)}),items.appendTo(c),c.data("index",items.contents().length),addElement.attr("id","sf2fc-add"),addElement.appendTo(containerAddElement),containerAddElement.appendTo(a(this)),containerAddElement.on("click",function(b){b.preventDefault();var d=c.data("prototype"),e=c.data("index"),f=new RegExp(params.tokenIndex,"g");d=d.replace(f,e),item=a('<div class="sf2fc-item"></div>'),item.append(d),link=a(params.removeItem),link.addClass("sf2fc-remove"),link.click(function(){a(this).parent().remove()}),item.append(link),params.sortable&&(link=a(params.sortItem),link.addClass("sf2fc-sort"),item.prepend(link)),c.find(".sf2fc-items").append(item),c.data("index",e+1)}),""!==params.removeItem&&c.find(".sf2fc-items").children("*").each(function(){link=a(params.removeItem),link.addClass("sf2fc-remove"),a(this).append(link),link.click(function(){a(this).parent().remove()})}),params.sortable&&(c.find(".sf2fc-items").sortable({cursor:"move",handle:".sf2fc-sort"}),c.find(".sf2fc-items").children("*").each(function(){link=a(params.sortItem),link.addClass("sf2fc-sort"),a(this).prepend(link)})),a(this)}}(jQuery);