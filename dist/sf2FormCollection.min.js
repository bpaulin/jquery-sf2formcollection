/*
 *  sf2FormCollection - v0.2.0
 *  sf2FormCollection
 *  https://github.com/bpaulin/jquery-sf2formcollection
 *
 *  Made by Bruno Paulin
 *  Under MIT License
 */
!function(a){function b(b,e){this.element=b,this.settings=a.extend({},d,e),this._defaults=d,this._name=c,this.init()}var c="sf2FormCollection",d={addItem:"Add an item",removeItem:"",tokenIndex:"__NAME__",sortable:!1,sortItem:'<a href="#">Sort</a>'};b.prototype={init:function(){var b=this,c=a('<div class="sf2fc-add"></div>'),d=a.parseHTML(this.settings.addItem),e=a('<div class="sf2fc-items"></div>');return a(this.element).children("*").each(function(){item=a('<div class="sf2fc-item"></div>'),a(this).detach().appendTo(item),item.appendTo(e)}),e.appendTo(a(this.element)),a(this.element).data("index",e.contents().length),a.each(d,function(a,b){c.append(b)}),c.appendTo(a(this.element)),c.on("click",function(c){c.preventDefault();var d=a(b.element).data("prototype"),e=a(b.element).data("index"),f=new RegExp(b.settings.tokenIndex,"g");d=d.replace(f,e),item=a('<div class="sf2fc-item"></div>'),item.append(d),link=a(b.settings.removeItem),link.addClass("sf2fc-remove"),link.click(function(){a(this).parent().remove()}),item.append(link),b.settings.sortable&&(link=a(b.settings.sortItem),link.addClass("sf2fc-sort"),item.prepend(link)),a(b.element).find(".sf2fc-items").append(item),a(b.element).data("index",e+1)}),""!==this.settings.removeItem&&a(this.element).find(".sf2fc-items").children("*").each(function(){link=a(b.settings.removeItem),link.addClass("sf2fc-remove"),a(this).append(link),link.click(function(){a(this).parent().remove()})}),this.settings.sortable&&(a(this.element).find(".sf2fc-items").sortable({cursor:"move",handle:".sf2fc-sort"}),a(this.element).find(".sf2fc-items").children("*").each(function(){link=a(b.settings.sortItem),link.addClass("sf2fc-sort"),a(this).prepend(link)})),a(this)}},a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})}}(jQuery,window,document);